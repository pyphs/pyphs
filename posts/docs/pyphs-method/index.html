<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>The class PyPHS.Method | PyPHS</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#618AC8">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../rss.xml">
<link rel="canonical" href="https://pyphs.github.io/pyphs/posts/docs/pyphs-method/">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="afalaize">
<link rel="prev" href="../port-hamiltonian-systems/" title="Port-Hamiltonian Systems" type="text/html">
<link rel="next" href="../../tutos/pyphs-core/" title="The class PyPHS.Core" type="text/html">
<meta property="og:site_name" content="PyPHS">
<meta property="og:title" content="The class PyPHS.Method">
<meta property="og:url" content="https://pyphs.github.io/pyphs/posts/docs/pyphs-method/">
<meta property="og:description" content="This class herits from the PHSCore class. It implements the symbolic expression of several numerical methods for the simulation of PHSCore. Below are the additional class attributes and class methods ">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-07-14T20:34:12+02:00">
<meta property="article:tag" content="mathjax">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://pyphs.github.io/pyphs/">
                <img src="../../../MyAwesomeIcon.png" alt="PyPHS" id="logo"><span id="blog-title">PyPHS</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Documentation <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="../port-hamiltonian-systems/">Port-Hamiltonian Systems</a>
                    </li>
<li class="active">
<a href=".">PyPHS.Method <span class="sr-only">(active)</span></a>
            </li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Tutorials <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="../../tutos/pyphs-core/">PyPHS.Core</a>
                    </li>
<li>
<a href="../../tutos/pyphs-evaluation/">PyPHS.Evaluation</a>
                    </li>
<li>
<a href="../../tutos/pyphs-graph/">PyPHS.Graph</a>
                    </li>
<li>
<a href="../../tutos/pyphs-simulation/">PyPHS.Simulation</a>
            </li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dictionary <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="../../dicos/electronics/electronics-index">Electronic</a>
                    </li>
<li>
<a href="../../dicos/magnetics/magnetics-index">Magnetic</a>
                    </li>
<li>
<a href="../../dicos/mechanics/mechanics-index">Mechanics</a>
                    </li>
<li>
<a href="../../dicos/thermics/thermics-index">Thermics</a>
                    </li>
<li>
<a href="../../dicos/mechanics_dual/mechanics_dual-index">Mechanics dual</a>
                    </li>
<li>
<a href="../../dicos/connectors/connectors-index">Connectors</a>
                    </li>
<li>
<a href="../../dicos/pwl/pwl-index">Piece-Wise Linear</a>
                    </li>
<li>
<a href="../../dicos/fraccalc/fraccalc-index">Fractional Calculus</a>
                    </li>
<li>
<a href="../../dicos/beams/beams-index">Beams</a>
                    </li>
<li>
<a href="../../dicos/transducers/transducers-index">Transducers</a>
            </li>
</ul>
</li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.ipynb" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">The class PyPHS.Method</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    <a href="../../../authors/afalaize/">afalaize</a>
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2017-07-14T20:34:12+02:00" itemprop="datePublished" title="2017-07-14 20:34">2017-07-14 20:34</time></a></p>
            
        <p class="sourceline"><a href="index.ipynb" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This class herits from the PHSCore class. It implements the symbolic expression of several numerical methods for the simulation of PHSCore. Below are the additional class attributes and class methods that differ from the parent PHSCore.</p>
<h2 id="Recall-of-the-Port-Hamiltonian-structure">Recall of the Port-Hamiltonian structure<a class="anchor-link" href="#Recall-of-the-Port-Hamiltonian-structure">¶</a>
</h2>$$
\left( 
\begin{array}{c}
\frac{\mathrm{d}\mathbf{x}_{\mathrm{}}}{\mathrm{d} t} \\
\mathbf{w}_{\mathrm{}} \\
\mathbf{y}_{\mathrm{}} \\
\end{array}
\right)
=
\underbrace{\left( 
\begin{array}{ccc}
\mathbf{M}_{\mathrm{xx}} &amp; \mathbf{M}_{\mathrm{xw}} &amp; \mathbf{M}_{\mathrm{xy}} \\
\mathbf{M}_{\mathrm{wx}} &amp; \mathbf{M}_{\mathrm{ww}} &amp; \mathbf{M}_{\mathrm{wy}} \\
\mathbf{M}_{\mathrm{yx}} &amp; \mathbf{M}_{\mathrm{yw}} &amp; \mathbf{M}_{\mathrm{yy}} \\
\end{array}
\right)}_{\mathbf M}
\cdot
\left( 
\begin{array}{c}
\nabla\mathrm{H}\\
\mathbf{z}_{\mathrm{}}\\
\mathbf{u}_{\mathrm{}}\\
\end{array}
\right).
\qquad (1)
$$<p>The quantites considered as arguments are</p>
<ul>
<li>the states $\mathbf{x}(t)$,</li>
<li>the dissipation variables $\mathbf{w}(t)$,</li>
<li>the inputs $\mathbf{u}(t)$,</li>
<li>the control parmameters $\mathbf{p}(t)$</li>
<li>the observed quantites $\mathbf{o}(t)$</li>
</ul>
<p>The significances of the <em>control parameters</em>  and <em>observed quantites</em> are described latter (consider $\mathbf{p}=\mathbf{o}=\emptyset$ for the moment).</p>
<p>The system functions are</p>
<ul>
<li>the Hamiltonian's gradient $\nabla \mathrm H \equiv \mathrm \nabla \mathrm H(\mathbf{x})$,</li>
<li>the structure matrix $\mathbf M \equiv \mathbf M(\mathbf{x}, \mathbf{w}, \mathbf{u}, \mathbf{p}, \mathbf{o})$, </li>
<li>the dissipation function $\mathbf z \equiv \mathbf z(\mathbf{x}, \mathbf{w}, \mathbf{u}, \mathbf{p}, \mathbf{o})$.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Discrete-state-derivative-and-update">Discrete state derivative and update<a class="anchor-link" href="#Discrete-state-derivative-and-update">¶</a>
</h2>
<p>In the sequel, we denote $\mathbf x^k \equiv \mathbf x(t^k)$ on the regular temporal grid $t^k = k\,\mathrm{T_s}$ for the sample period $\mathrm{T_s}$ with associated sample rate $\mathrm{F_s}=\mathrm{T}_\mathrm{s}^{-1}$. Then, a one-stage progressive finite difference approximation of the state derivative is 
$$\frac{\mathrm{d}\mathbf{x}_{\mathrm{}}(t^k)}{\mathrm{d} t} \simeq \frac{\delta\mathbf{x}^k_{\mathrm{}}}{\mathrm{T_s}}, \qquad (2)$$ 
where
$$\delta\mathbf{x}^k_{\mathrm{}} \triangleq \mathbf{x}_{\mathrm{}}^{k+1} - \mathbf{x}_{\mathrm{}}^{k}, \qquad (3)$$ 
Now, the update is simply given by
$$\mathbf{x}_{\mathrm{}}^{k+1} = \mathbf{x}_{\mathrm{}}^{k}+\delta\mathbf{x}^k_{\mathrm{}}. \qquad (4)$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Discrete-arguments">Discrete arguments<a class="anchor-link" href="#Discrete-arguments">¶</a>
</h2>
<p>Quantites considered as <strong>arguments</strong> are now</p>
<ul>
<li>the states $\mathbf{x}^k$,</li>
<li>the states increments $\delta\mathbf{x}^k$,</li>
<li>the dissipation variables $\mathbf{w}^k$,</li>
<li>the inputs $\mathbf{u}^k$,</li>
<li>the control parmameters $\mathbf{p}^k$,</li>
<li>the observed quantites $\mathbf{o}^k$,</li>
</ul>
<p>which are collected in a single vector
$$
\mathbf{args^k}_{\mathrm{}} \triangleq \left( 
\begin{array}{c}
\mathbf{x}^k\\
\delta\mathbf{x}^k\\
\mathbf{w}^k\\
\mathbf{u}^k\\
\mathbf{p}^k\\
\mathbf{o}^k
\end{array}
\right).\qquad
\begin{array}{l}
\mathrm{States}\\
\mathrm{States~increments}\\
\mathrm{Dissipation~variables}\\
\mathrm{Inputs}\\
\mathrm{Control~parameters}\\
\mathrm{Observed~quantities}
\end{array}
$$
The significances of the <em>control parameters</em>  and <em>observed quantites</em> are described latter (consider $\mathbf{p}^k=\mathbf{o}^k=\emptyset$ for the moment).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Numerical-methods">Numerical methods<a class="anchor-link" href="#Numerical-methods">¶</a>
</h2>
<p>A <strong>numerical method</strong> consists in the prescription of a numerical equivalent to system (1), that is, in the prescription of numerical equivalents for</p>
<ul>
<li>the Hamiltonian's gradient $\nabla \mathrm H \leftarrow \overline{\nabla}\mathrm{H}(\mathbf{args}_{\mathrm{}})$,</li>
<li>the structure matrix $\mathbf M \leftarrow \overline{\mathbf M}(\mathbf{args}_{\mathrm{}})$, </li>
<li>the dissipation function $\mathbf z \leftarrow \overline{\mathbf z}(\mathbf{args}_{\mathrm{}})$.</li>
</ul>
<p>This yields the following <strong>discrete system</strong></p>
$$
\left( 
\begin{array}{c}
\frac{\delta\mathbf{x}^k_{\mathrm{}}}{\mathrm{T_s}} \\
\mathbf{w}^k_{\mathrm{}} \\
\mathbf{y}^k_{\mathrm{}}
\end{array}
\right)
=
\overline{\mathbf{M}}(\mathbf{args}^k_{\mathrm{}})
\cdot
\left( 
\begin{array}{c}
\overline{\nabla}\mathrm{H}(\mathbf{args}^k_{\mathrm{}})\\
\overline{\mathbf z}(\mathbf{args}^k_{\mathrm{}})\\
\mathbf{u}^k_{\mathrm{}}
\end{array}
\right).
\qquad (5)
$$<p>Now, provided</p>
<ul>
<li>a state initialization {$\mathbf{x}^k\}_{k = 0}$,</li>
<li>an input sequence {$\mathbf{u}^k\}_{0\leq k \leq K}$,</li>
<li>a control sequence {$\mathbf{p}^k\}_{0\leq k \leq K}$,</li>
<li>an observed sequence {$\mathbf{o}^k\}_{0\leq k \leq K}$,</li>
</ul>
<p>the simulation is performed by solving (5) iteratively for the state increment $\delta\mathbf{x}^k$ and the dissipation variable $\mathbf{w}^k$ (which are the only unknown in $\mathbf{args}^k$), and then updating according to (4).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Theta-method">The Theta method<a class="anchor-link" href="#The-Theta-method">¶</a>
</h3>
<p>For a standard dynamical system, this method reads 
$$ \dot{\mathbf{x}}=\mathbf{f}(\mathbf{x}) \longrightarrow \frac{\delta\mathbf{x}^{k}}{\mathrm{T_s}} = \mathbf{f}(\mathbf{x}^k + \theta \, \delta\mathbf{x}^k).$$
It includes the explicit (respectively implicit) Euler scheme for $\theta = 0$ (respectively $\theta = 1$), and the midpoint rule for $\theta = \mbox{½}$.</p>
<p>Applying this scheme to the system (1) yields the following numerical equivalents:</p>
<ul>
<li>$\overline{\nabla}\mathrm{H}(\mathbf{args}^k_{\mathrm{}}) \triangleq {\nabla}\mathrm{H}(\mathbf x^k+ \theta \, \delta\mathbf{x}^k)$,</li>
<li>$\overline{\mathbf M}(\mathbf{args}^k_{\mathrm{}}) \triangleq \mathbf M(\mathbf x^k+ \theta \, \delta\mathbf{x}^k, \mathbf{w}^k, \mathbf{u}^k, \mathbf{p}^k, \mathbf{o}^k)$, </li>
<li>$\overline{\mathbf z}(\mathbf{args}^k_{\mathrm{}}) \triangleq \mathbf z(\mathbf x^k+ \theta \, \delta\mathbf{x}^k, \mathbf{w}^k, \mathbf{u}^k, \mathbf{p}^k, \mathbf{o}^k)$.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Trapezoidal-method">The Trapezoidal method<a class="anchor-link" href="#The-Trapezoidal-method">¶</a>
</h3>
<p>For a standard dynamical system, this method reads 
$$ \dot{\mathbf{x}} = \mathbf{f}(\mathbf{x}) \longrightarrow  \frac{\delta\mathbf{x}^{k}}{\mathrm{T_s}} = \frac{1}{2} \Big(\mathbf{f}(\mathbf{x}^k) + \mathbf{f}(\mathbf{x}^k+ \delta\mathbf x^k)\Big).$$</p>
<p>Applying this scheme to the system (1) yields the following numerical equivalents:</p>
<ul>
<li>$\overline{\nabla}\mathrm{H}(\mathbf{args}^k_{\mathrm{}}) \triangleq \frac{1}{2} \Big({\nabla}\mathrm{H}(\mathbf x^k) + {\nabla}\mathrm{H}(\mathbf x^k+ \delta\mathbf{x}^k)\Big)$,</li>
<li>$\overline{\mathbf M}(\mathbf{args}^k_{\mathrm{}}) \triangleq 
\frac{1}{2} \Big(\mathbf M(\mathbf{x}^k, \mathbf{w}^k, \mathbf{u}^k, \mathbf{p}^k, \mathbf{o}^k) + \mathbf M(\mathbf{x}^k+ \delta\mathbf x^k, \mathbf{w}^k, \mathbf{u}^k, \mathbf{p}^k, \mathbf{o}^k)\Big)$, </li>
<li>$\overline{\mathbf z}(\mathbf{args}^k_{\mathrm{}}) \triangleq 
\frac{1}{2} \Big(\mathbf z(\mathbf{x}^k, \mathbf{w}^k, \mathbf{u}^k, \mathbf{p}^k, \mathbf{o}^k) + \mathbf z(\mathbf{x}^k+ \delta\mathbf x^k, \mathbf{w}^k, \mathbf{u}^k, \mathbf{p}^k, \mathbf{o}^k)\Big)$.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Discrete-Gradient-method">The Discrete Gradient method<a class="anchor-link" href="#The-Discrete-Gradient-method">¶</a>
</h3>
<p>For a standard Hamiltonian system with a separate Hamiltonian $\mathrm H(\mathbf x) = \sum_{i=1}^{\mathrm{dim}(\mathbf x)} \mathrm H_i(x_i)$, this method reads 
$$ \dot{\mathbf{x}} = \mathbf J(\mathbf x)\cdot \nabla\mathrm{H}(\mathbf{x})
\longrightarrow \frac{\delta\mathbf{x}^{k}}{\mathrm{T_s}} = \mathbf J(\mathbf x^k+\theta\, \delta\mathbf x^k)\cdot \overline \nabla \mathrm H (\mathbf x^k, \delta \mathbf x^k),$$
with 
$$ 
\left[\overline \nabla \mathrm H (\mathbf x, \delta \mathbf x)\right]_i =
\left\{
\begin{array}{l}
\frac{\mathrm H_i(x_i+\delta x_i)- \mathrm H_i (x_i)}{\delta x_i} \text{ if } \delta x_i \geq 0, \\
\mathrm H_i^\prime(x_i) \mbox{ else},
\end{array}
\right.
 \quad \mbox{for  } {1\leq i \leq \mathrm{dim}(x)}. \qquad (6)
$$</p>
<p>Applying this scheme to the system (1) yields the following numerical equivalents:</p>
<ul>
<li>$\overline{\nabla}\mathrm{H}(\mathbf{args}^k_{\mathrm{}})$ is given by ( 6),</li>
<li>$\overline{\mathbf M}(\mathbf{args}^k_{\mathrm{}}) \triangleq \mathbf M(\mathbf x^k+ \theta \, \delta\mathbf{x}^k, \mathbf{w}^k, \mathbf{u}^k, \mathbf{p}^k, \mathbf{o}^k)$ (same as Theta method), </li>
<li>$\overline{\mathbf z}(\mathbf{args}^k_{\mathrm{}}) \triangleq \mathbf z(\mathbf x^k+ \theta \, \delta\mathbf{x}^k, \mathbf{w}^k, \mathbf{u}^k, \mathbf{p}^k, \mathbf{o}^k)$ (same as Theta method).</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Resolution">Resolution<a class="anchor-link" href="#Resolution">¶</a>
</h3>
<h4 id="Arguments">Arguments<a class="anchor-link" href="#Arguments">¶</a>
</h4>
<p>The values for</p>
<ul>
<li>the states $\mathbf{x}^k$,</li>
<li>the inputs $\mathbf{u}^k$,</li>
<li>the control parmameters $\mathbf{p}^k$,</li>
<li>the observed quantites $\mathbf{o}^k$,</li>
</ul>
<p>are known at the begining of each time step. These quantities are constant over a time-step, and are collected in a singe vector:
$$
\mathbf{c}_{\mathrm{}} \triangleq \left( 
\begin{array}{c}
\mathbf{x} \\
\mathbf{u} \\
\mathbf{p} \\
\mathbf{o} \\
\end{array}
\right).
$$
The only unknown quantities in (5) and $\mathbf{args}$ are</p>
<ul>
<li>the states increments $\delta\mathbf{x}^k$,</li>
<li>the dissipation variables $\mathbf{w}^k$.</li>
</ul>
<p>These unknown quantities are collected in a singe vector:
$$
\mathbf{v}_{\mathrm{}} \triangleq \left( 
\begin{array}{c}
\delta\mathbf{x} \\
\mathbf{w}_{\mathrm{}}
\end{array}
\right),\qquad (7)
$$
and $\mathbf{args} \equiv (\mathbf{v}, \mathbf{c})$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Update">Update<a class="anchor-link" href="#Update">¶</a>
</h4>
<p>Similarly, the constitutive relations are collected in a single vector valued function:
$$
\mathbf{f}_{\mathrm{}}(\mathbf{v}, \mathbf{c}) \triangleq \left( 
\begin{array}{c}
\overline \nabla\mathrm{H}(\mathbf{v}, \mathbf{c})\\
\overline{\mathbf{z}}_{\mathrm{}}(\mathbf{v}, \mathbf{c})
\end{array}
\right), \qquad (8)
$$
and we define the following matrices (without expressing the dependance on $\mathbf{args} \equiv (\mathbf{v}, \mathbf{c})$):
$$
\begin{array}{llc}
\overline{\mathbf{M}}_{\mathrm{vv}}= \left( 
\begin{array}{ccc}
\overline{\mathbf{M}}_{\mathrm{xx}} &amp; \overline{\mathbf{M}}_{\mathrm{xw}}  \\
\overline{\mathbf{M}}_{\mathrm{wx}} &amp; \overline{\mathbf{M}}_{\mathrm{ww}}
\end{array}
\right), 
&amp;
\overline{\mathbf{M}}_{\mathrm{vy}} = \left( 
\begin{array}{ccc}
\overline{\mathbf{M}}_{\mathrm{xy}}\\
\overline{\mathbf{M}}_{\mathrm{wy}}
\end{array}
\right), 
&amp; (9) 
\\
\overline{\mathbf{M}}_{\mathrm{yv}} = \left( 
\begin{array}{ccc}
\overline{\mathbf{M}}_{\mathrm{yx}} &amp; \overline{\mathbf{M}}_{\mathrm{yw}}
\end{array}
\right), 
&amp;
\overline{\mathbf{I}}= \left( 
\begin{array}{ccc}
\mathrm{F_s}\,\mathbf{I_d}(n_\mathbf{x}) &amp; \mathbf 0 \\
\mathbf 0  &amp; \mathbf{I_d}(n_\mathbf{w})
\end{array}
\right),
&amp; (10)
\end{array}
$$
where $n_\mathbf{x}=\mathrm{dim}(\mathbf x)$ and $n_\mathbf{w}=\mathrm{dim}(\mathbf w)$. Then, system (2) is rewritten as</p>
<ol>
<li>Solve $\mathbf{F}(\mathbf v^k, \mathbf c^k)=\mathbf 0 $ for $\mathbf v^k$, where $$\mathbf{F}(\mathbf v^k, \mathbf c^k) \triangleq  \overline{\mathbf{I}}\cdot\mathbf v^k - \mathbf M_{\mathrm{vv}}\cdot\mathbf{f}_{\mathrm{}}(\mathbf v^k, \mathbf c^k) - \mathbf M_{\mathrm{vy}}\cdot\mathbf u^k, \qquad (11)$$</li>
<li>Set $$\mathbf y^k =  \mathbf M_{\mathrm{yv}}\cdot\mathbf{f}_{\mathrm{}}(\mathbf{v}^k, \mathbf c^k) + \mathbf M_{\mathrm{yy}}\cdot\mathbf u^k, \qquad (12)$$</li>
<li>Set $$\mathbf x^{k+1} =  \mathbf x^k + \delta\mathbf x^k. \qquad (13)$$</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Explicit-and-implicit-updates">Explicit and implicit updates<a class="anchor-link" href="#Explicit-and-implicit-updates">¶</a>
</h3>
<p>Depending on the original system (1) and on the chosen numerical method, some components of the implicit function $\mathbf{F}(\mathbf v)$ in (11) may be explicited up to a matrix inversion. In order to detect these <em>explicit</em> components, we analyse the structure of the <strong>jacobian matrix</strong> of $\mathcal J_{\mathbf{F},\mathbf v}(\mathbf v)$ defined by
$$\Big[\mathcal J_{\mathbf{F},\mathbf v}(\mathbf v, \mathbf c)\Big]_{i,j} = \frac{\partial \mathbf F_i (\mathbf v, \mathbf c)}{\partial \mathbf v_j}.
$$
The result is the following spliting:
$$\mathbf x = \left( 
\begin{array}{c}
\mathbf x_\mathrm{E} \\
\mathbf x_\mathrm{I}
\end{array}
\right), \quad \mathbf w = \left( 
\begin{array}{c}
\mathbf w_\mathrm{E} \\
\mathbf w_\mathrm{I}
\end{array}
\right), \qquad (14)
$$
and 
$$\mathbf v_\mathrm{E} = \left( 
\begin{array}{c}
\delta \mathbf x_\mathrm{E} \\
\mathbf w_\mathrm{E}
\end{array}
\right), \quad \mathbf v_\mathrm{I} = \left( 
\begin{array}{c}
\delta \mathbf x_\mathrm{I} \\
\mathbf w_\mathrm{I}
\end{array}
\right), \qquad (15)
$$
such that the columns of $\mathcal J_{\mathbf{F}, \mathbf v_\mathrm{E}}(\mathbf v, \mathbf c)$ associated with $\mathbf v_\mathrm{E}$ does no depend on $\mathbf v\equiv(\mathbf v_\mathrm{E}, \mathbf v_\mathrm{I})$.</p>
<p>According to (7-11), we define the following expressions (without expressing the dependance on $\mathbf{args} \equiv (\mathbf{v}, \mathbf{c})$):
$$
\mathbf{f}_\mathrm{E} \triangleq \left( 
\begin{array}{c}
\overline \nabla\mathrm{H}_\mathrm{E}\\
\overline{\mathbf{z}}_\mathrm{E}
\end{array}
\right), \quad \mathbf{f}_\mathrm{I} \triangleq \left( 
\begin{array}{c}
\overline \nabla\mathrm{H}_\mathrm{I}\\
\overline{\mathbf{z}}_\mathrm{I}
\end{array}
\right)\qquad (16)
$$
$$
\begin{array}{llc}
\overline{\mathbf{M}}_{\mathrm{vEvE}} = \left( 
\begin{array}{ccc}
\overline{\mathbf{M}}_{\mathrm{xExE}} &amp; \overline{\mathbf{M}}_{\mathrm{xEwE}}  \\
\overline{\mathbf{M}}_{\mathrm{wExE}} &amp; \overline{\mathbf{M}}_{\mathrm{wEwE}}
\end{array}
\right), 
&amp;
\overline{\mathbf{M}}_{\mathrm{vIvI}} = \left( 
\begin{array}{ccc}
\overline{\mathbf{M}}_{\mathrm{xIxI}} &amp; \overline{\mathbf{M}}_{\mathrm{xIwI}}  \\
\overline{\mathbf{M}}_{\mathrm{wIxI}} &amp; \overline{\mathbf{M}}_{\mathrm{wIwI}}
\end{array}
\right), 
&amp;
(17) 
\\
\overline{\mathbf{M}}_{\mathrm{vEvI}} = \left( 
\begin{array}{ccc}
\overline{\mathbf{M}}_{\mathrm{xExI}} &amp; \overline{\mathbf{M}}_{\mathrm{xEwI}} \\
\overline{\mathbf{M}}_{\mathrm{wExI}} &amp; \overline{\mathbf{M}}_{\mathrm{wEwI}}
\end{array}
\right), 
&amp;
\overline{\mathbf{M}}_{\mathrm{vIvE}} = \left( 
\begin{array}{ccc}
\overline{\mathbf{M}}_{\mathrm{xIxE}} &amp; \overline{\mathbf{M}}_{\mathrm{xIwE}}  \\
\overline{\mathbf{M}}_{\mathrm{wIxE}}&amp; \overline{\mathbf{M}}_{\mathrm{wIwE}}
\end{array}
\right), 
&amp;
(18) 
\\
\overline{\mathbf{M}}_{\mathrm{vEy}}= 
\left( 
\begin{array}{ccc}
\overline{\mathbf{M}}_{\mathrm{xEy}}\\
\overline{\mathbf{M}}_{\mathrm{wEy}}
\end{array}
\right), 
&amp;
\overline{\mathbf{M}}_{\mathrm{vIy}}= \left( 
\begin{array}{ccc}
\overline{\mathbf{M}}_{\mathrm{xIy}}\\
\overline{\mathbf{M}}_{\mathrm{wIy}}
\end{array}
\right), 
&amp;
(19)
\\
\overline{\mathbf{I}}_{\mathrm{E}}= \left( 
\begin{array}{ccc}
\mathrm{F_s}\,\mathbf{I_d}(n_{\mathbf{x}_{\mathrm E}}) &amp; \mathbf 0 \\
\mathbf 0  &amp; \mathbf{I_d}(n_{\mathbf{w}_{\mathrm E}})
\end{array}
\right),
&amp; 
\overline{\mathbf{I}}_{\mathrm{I}}= \left( 
\begin{array}{ccc}
\mathrm{F_s}\,\mathbf{I_d}(n_{\mathbf{x}_{\mathrm I}}) &amp; \mathbf 0 \\
\mathbf 0  &amp; \mathbf{I_d}(n_{\mathbf{w}_{\mathrm I}})
\end{array}
\right), 
&amp; (20)
\end{array}
$$
where $n_{\mathbf{x}_{\mathrm E}}=\mathrm{dim}(\mathbf x_{\mathrm E})$, $n_{\mathbf{x}_{\mathrm I}}=\mathrm{dim}(\mathbf x_{\mathrm I})$, $n_{\mathbf{w}_{\mathrm I}}=\mathrm{dim}(\mathbf w_{\mathrm I})$ and $n_{\mathbf{w}_{\mathrm E}}=\mathrm{dim}(\mathbf w_{\mathrm E})$, and
$$\mathbf{F}_{\mathrm{E}}(\mathbf v,  \mathbf{c}) \triangleq  \overline{\mathbf{I}}_{\mathrm{E}}\cdot\mathbf v_{\mathrm{E}} - \mathbf M_{\mathrm{vEvE}}\cdot\mathbf{f}_{\mathrm{E}}(\mathbf v,  \mathbf{c})- \mathbf M_{\mathrm{vEvI}}\cdot\mathbf{f}_{\mathrm{I}}(\mathbf v,  \mathbf{c}) - \mathbf M_{\mathrm{vEy}}\cdot\mathbf u, \qquad (21)$$
$$\mathbf{F}_{\mathrm{I}}(\mathbf v,  \mathbf{c}) \triangleq  \overline{\mathbf{I}}_{\mathrm{I}}\cdot\mathbf v_{\mathrm{I}} - \mathbf M_{\mathrm{vIvE}}\cdot\mathbf{f}_{\mathrm{E}}(\mathbf v,  \mathbf{c})- \mathbf M_{\mathrm{vIvI}}\cdot\mathbf{f}_{\mathrm{I}}(\mathbf v,  \mathbf{c}) - \mathbf M_{\mathrm{vEy}}\cdot\mathbf u. \qquad (22)$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, define $\mathbf{G}(\mathbf v, \mathbf c)$ as the local deviation of $\mathbf{F}(\mathbf v, \mathbf c)$ from its linear behavior w.r.t $\mathbf v_\mathrm{E}$:
$$\mathbf{G}(\mathbf v, \mathbf c) \triangleq  \mathbf{F}(\mathbf v, \mathbf c) - \mathcal J_{\mathbf{F},\mathbf v_{\mathrm{E}}}(\mathbf v, \mathbf c) \cdot\mathbf v_{\mathrm{E}}, \qquad (23)$$
and correspondingly
$$\mathbf{G}_{\mathrm{E}}(\mathbf v, \mathbf c) \triangleq  \mathbf{F}_{\mathrm{E}}(\mathbf v, \mathbf c) - \mathcal J_{\mathbf{F}_{\mathrm{E}}, \mathbf v_{\mathrm{E}}}(\mathbf v, \mathbf c)\cdot\mathbf v_{\mathrm{E}}, \qquad (24)$$
$$\mathbf{G}_{\mathrm{I}}(\mathbf v, \mathbf c) \triangleq  \mathbf{F}_{\mathrm{I}}(\mathbf v, \mathbf c) - \mathcal J_{\mathbf{F}_{\mathrm{I}}, \mathbf v_{\mathrm{E}}}(\mathbf v, \mathbf c) \cdot\mathbf v_{\mathrm{E}}. \qquad (25)$$</p>
<p>Notice that by definition $\mathcal J_{\mathbf{F}_{\mathrm{E}}, \mathbf v_{\mathrm{E}}}(\mathbf v, \mathbf c)\equiv \mathcal J_{\mathbf{F}_{\mathrm{E}}, \mathbf v_{\mathrm{E}}}(\mathbf c)$ is constant over a time-step. This yields $\mathbf{G}_{\mathrm{E}}(\mathbf v, \mathbf c) \equiv \mathbf{G}_{\mathrm{E}}(\mathbf v_{\mathrm{I}}, \mathbf c) $ for the root $\mathbf{F}_{\mathrm{E}}(\mathbf v^*, \mathbf c)=\mathbf 0$:
$$\mathbf v_{\mathrm{E}}^* =  -\mathcal J_{\mathbf{F}_{\mathrm{E}}, \mathbf v_{\mathrm{E}}}^{-1}(\mathbf c) \cdot \mathbf{G}_{\mathrm{E}}(\mathbf v_{\mathrm{I}}^*, \mathbf c).\qquad (26)$$</p>
<p>Now, rewrite $\mathbf{F}_{\mathrm{I}}(\mathbf v, \mathbf c)$ as
$$\begin{array}{rcl}
\mathbf{F}_{\mathrm{I}}(\mathbf v, \mathbf c) &amp;=&amp; \mathbf{G}_{\mathrm{I}}(\mathbf v_{\mathrm{I}}, \mathbf c) + \mathcal J_{\mathbf{F}_{\mathrm{I}}, \mathbf v_{\mathrm{E}}}(\mathbf c)\cdot\mathbf v_{\mathrm{E}} \\
&amp;=&amp;\mathbf{G}_{\mathrm{I}}(\mathbf v_{\mathrm{I}}, \mathbf c) - \mathcal J_{\mathbf{F}_{\mathrm{I}}, \mathbf v_{\mathrm{E}}}(\mathbf c)\cdot\mathcal J_{\mathbf{F}_{\mathrm{E}}, \mathbf v_{\mathrm{E}}}^{-1}(\mathbf c) \cdot \mathbf{G}_{\mathrm{E}}(\mathbf v_{\mathrm{I}}, \mathbf c)\equiv \mathbf{F}_{\mathrm{I}}(\mathbf v_{\mathrm{I}}, \mathbf c),
\end{array}$$
with
$$
\mathcal J_{\mathbf{F}_{\mathrm{I}}, \mathbf v_{\mathrm{I}}}(\mathbf v_{\mathrm{I}}) = \mathcal J_{\mathbf{G}_{\mathrm{I}}, \mathbf v_{\mathrm{I}}}(\mathbf v_{\mathrm{I}}) - \mathcal J_{\mathbf{F}_{\mathrm{I}}, \mathbf v_{\mathrm{E}}}\cdot\mathcal J_{\mathbf{F}_{\mathrm{E}}, \mathbf v_{\mathrm{E}}}^{-1} \cdot \mathcal J_{\mathbf{G}_{\mathrm{E}}, \mathbf v_{\mathrm{I}}}(\mathbf v_{\mathrm{I}}).
$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, the resolution algorithm for the system (2) is</p>
<ol>
<li>$\mathbf x^k \leftarrow \mathbf x^{-1} + \delta\mathbf x^{k-1}$,</li>
<li>$\mathbf c^k \leftarrow (\mathbf x^k, \mathbf u^k, \mathbf p^k, \mathbf o^k)$,</li>
<li>$\mathbf v_{\mathrm{I}}^k\leftarrow \mathbf v_{\mathrm{I}}^*$ such that $\mathbf{F}_{\mathrm{I}}(\mathbf v_{\mathrm{I}}^*, \mathbf c^k)=0$,</li>
<li>$\mathbf v_{\mathrm{E}}^k\leftarrow-\mathcal J_{\mathbf{F}_{\mathrm{E}}, \mathbf v_{\mathrm{E}}}^{-1}(\mathbf c^k) \cdot \mathbf{G}_{\mathrm{E}}(\mathbf v_{\mathrm{I}}^k, \mathbf c^k)$,</li>
<li>$\mathbf y^k\leftarrow\mathbf M_{\mathrm{yv}}\cdot\mathbf{f}_{\mathrm{}}(\mathbf{v}^k, \mathbf c^k) + \mathbf M_{\mathrm{yy}}\cdot\mathbf u^k$.</li>
</ol>
</div>
</div>
</div>
    </div>
  </div>

    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags"></ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../port-hamiltonian-systems/" rel="prev" title="Port-Hamiltonian Systems">Previous post</a>
            </li>
            <li class="next">
                <a href="../../tutos/pyphs-core/" rel="next" title="The class PyPHS.Core">Next post</a>
            </li>
        </ul></nav></aside><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha256-SDRP1VVYu+tgAGKhddBSl5+ezofHKZeI+OzxakbIe/Y=" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'left' if you want left-aligned equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2019         <a href="mailto:pyphs.project@gmail.com">PyPHS project</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
