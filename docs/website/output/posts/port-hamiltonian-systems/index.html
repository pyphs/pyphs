<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<base href="https://afalaize.github.io/pyphs/posts/port-hamiltonian-systems/">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Port-Hamiltonian Systems | PyPHS</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#618AC8" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://afalaize.github.io/pyphs/posts/port-hamiltonian-systems/">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'left', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script><!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="afalaize">
<link rel="prev" href="../electronics/" title="Electronics" type="text/html">
<link rel="next" href="../storage-components/" title="Storage components" type="text/html">
<meta property="og:site_name" content="PyPHS">
<meta property="og:title" content="Port-Hamiltonian Systems">
<meta property="og:url" content="https://afalaize.github.io/pyphs/posts/port-hamiltonian-systems/">
<meta property="og:description" content="In this tutorial, we recall the port-Hamiltonian systems (PHS) formalism in section 1, and we give an example with the standard serial resistor-coil-capacitor (RLC) circuit in section 2.

The followin">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-02-11T18:19:33+01:00">
<meta property="article:tag" content="mathjax">
<meta property="article:tag" content="theory">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://afalaize.github.io/pyphs/">
                <img src="../../MyAwesomeIcon.png" alt="PyPHS" id="logo"><span id="blog-title">PyPHS</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Tutorials <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="../phscore/">PHSCore</a>
                    </li>
<li>
<a href="../phsnumericaleval/">PHSNumericalEval</a>
                    </li>
<li>
<a href="../phssimulation/">PHSSimulation</a>
            </li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dictionary <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="../electronics/">Electronic</a>
                    </li>
<li>
<a href="../../building/">Mechanic</a>
                    </li>
<li>
<a href="../../building/">Magnetic</a>
            </li>
</ul>
</li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.rst" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Port-Hamiltonian Systems</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                    afalaize
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2017-02-11T18:19:33+01:00" itemprop="datePublished" title="2017-02-11 18:19">2017-02-11 18:19</time></a></p>
            
        <p class="sourceline"><a href="index.rst" id="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>In this tutorial, we recall the <em>port-Hamiltonian systems (PHS)</em> formalism in section 1, and we give an example with the standard serial resistor-coil-capacitor (RLC) circuit in section 2.</p>
<!-- TEASER_END: click to read the rest of the article -->
<p>The following presentation is adapted from the reference <a class="citation-reference" href="#fh2016" id="id1">[FH2016]</a>.</p>
<hr class="docutils">
<div class="section" id="formalism-and-properties">
<h2>1 Formalism and properties</h2>
<p>Denote <span class="math">\(E(t)\geq 0\)</span> the energy <em>stored</em> in an open physical system. If the system is conservative, its time variation <span class="math">\(\frac{\mathrm d \mathrm E}{\mathrm d t}(t)\)</span> reduces to <span class="math">\(\mathrm S(t)\)</span> the power <strong>received</strong> by the <em>sources</em> through the external ports. If the system includes dissipative phenomena, <span class="math">\(\mathrm D(t)\geq0\)</span> is the <em>dissipated</em> power, and the evolution of energy is governed by the following instantaneous <strong>power balance</strong>:</p>
<div class="math">
\begin{equation*}
\begin{array}{lr}\frac{\mathrm d \mathrm E}{\mathrm d t}(t) + \mathrm D(t) + \mathrm S(t)=0.  &amp; \qquad\qquad(1)\end{array}
\end{equation*}
</div>
<p>The port-Hamiltonian approach is used to decompose such open physical systems into (i) a set of components that are combined according to (ii) a conservative interconnection network. These two ingredients are detailed below.</p>
<div class="section" id="components">
<h3>1.1. Components</h3>
<p>The elementary components of multiphysical systems are sorted as (or can be a combination of):</p>
<ul class="simple">
<li>
<span class="math">\(n_S\)</span> internal components that store energy <span class="math">\(\mathrm E \geq 0\)</span> (capacitor, inductor, spring, mass, heat capacity, etc.),</li>
<li>
<span class="math">\(n_D\)</span> internal components that dissipate power <span class="math">\(\mathrm D\geq 0\)</span> (resistor, diode, damper, etc.),</li>
<li>
<span class="math">\(n_P\)</span> external ports that convey power <span class="math">\(\mathrm S(\in \mathbb R)\)</span> from sources (current/voltage source, external force, imposed velocity/temperature, etc.), or any external system (active, dissipative, or mixed).</li>
</ul>
<p>The behavior of each component is described by a relation between two power variables: the <em>flux</em> <span class="math">\(f\)</span> and the <em>effort</em> <span class="math">\(e\)</span>, defined in <strong>receiver convention</strong> (the <em>received</em> power is <span class="math">\(\mathrm P=e\cdot f\)</span>, including for the sources).</p>
<div class="section" id="storage-components">
<h4>Storage components</h4>
<p>The energy <span class="math">\(\mathrm E_s\)</span> stored in storage component <span class="math">\(s\in [1,\,\cdots ,\,n_S]\)</span> is expressed as a <em>storage function</em> <span class="math">\(h_s\)</span> of an appropriate state <span class="math">\(x_s\)</span>: <span class="math">\(\mathrm E_s(t)=h_s(x_s(t))\geq 0\)</span>.</p>
<dl class="docutils">
<dt>Example 1:</dt>
<dd>For a linear inductor with inductance <span class="math">\(L\)</span>, the state can be the magnetic flux <span class="math">\(x_L=\phi\)</span> and the positive definite function is <span class="math">\(h_L(\phi)=\phi^2/(2\,L)\)</span>.</dd>
<dt>Example 2:</dt>
<dd>For a nonlinear cubic spring with linear stiffness <span class="math">\(K\)</span> and nonlinearity coefficient <span class="math">\(\alpha\)</span>, the state can be the ellongation <span class="math">\(x_K=\ell\)</span> and the positive definite function is <span class="math">\(h_K(\ell)=\frac{K}{2}\ell^2\,(1 + \frac{\alpha}{2}\ell^2)\)</span>.</dd>
</dl>
<p>Storage power variables (<span class="math">\(e_s\)</span>, <span class="math">\(f_s\)</span>) are related to the variation of the state <span class="math">\(\frac{\mathrm d x_s}{\mathrm dt}\)</span> and the gradient of the storage function <span class="math">\(h^\prime _s(x_s)\)</span>, the product of which is precisely the received power: <span class="math">\(e_s\,f_s=\frac{\mathrm d \mathrm E}{\mathrm d t}=h^\prime _s\,\frac{\mathrm d x_s}{\mathrm d t}\)</span>.</p>
<dl class="docutils">
<dt>Example 1 (continued):</dt>
<dd>For the above linear inductor, these constitutive laws are the voltage (effort) <span class="math">\(e_L=V_L=\frac{\mathrm d \phi}{\mathrm d t}=\frac{\mathrm d x_L}{\mathrm d t}\)</span> and the current (flux) <span class="math">\(i_L=\frac{\phi}{L}=h^\prime_L\)</span>, the product of which <span class="math">\(P_{L}=V_L\,i_L\)</span> is the electrical power.</dd>
<dt>Example 2 (continued):</dt>
<dd>For the above nonlinear cubic spring, these constitutive laws are the velocity (flux) <span class="math">\(v_K=\frac{\mathrm d \ell}{\mathrm d t}=\frac{\mathrm d x_K}{\mathrm d t}\)</span> and the mechanical force (effort) <span class="math">\(F_K=K\,(\ell+\alpha\,\ell^3)=h^\prime_K\)</span>, the product of which <span class="math">\(P_{K}=F_K\,v_K\)</span> is the mechanical power (<em>i.e.</em> variation of mechanical work).</dd>
</dl>
<p>Finally, the total energy of a system with <span class="math">\(n_S\)</span> storage components is <span class="math">\(\mathrm E =\mathrm H(\mathbf x) = \sum_{i=1}^{N}h_i(x_i)\)</span>. The total storage function <span class="math">\(\mathrm H: \mathbb R^N \mapsto \mathbb R_{+}\)</span> is called the  <strong>Hamiltonian</strong> of the system. Then, the total energy variation of the system is <span class="math">\(P_{\mathrm{storage}}=\frac{\mathrm d E}{\mathrm d t} = \nabla \mathrm H \cdot \frac{\mathrm d \mathbf x}{\mathrm d t}= \sum_{i=1}^N \frac{\partial h}{x_i}\,\frac{\mathrm d x_i}{\mathrm d t}\)</span>.</p>
<blockquote>
Note the above definitions can be straightforwardly extended to account for storage components defined by a multivariate storage functions <span class="math">\(h_s(\mathbf x_s)\)</span> with state <span class="math">\(\mathbf x_s = (x_{s,1},\,\cdots,\, x_{s,n})^\intercal\)</span> and associated received power <span class="math">\(\mathrm P_s = \frac{\mathrm d h_s(\mathbf x_s)}{\mathrm d t} = \nabla h_s \cdot \frac{\mathrm d \mathbf x_s}{\mathrm d t}= \sum_{i=1}^n \frac{\partial h_{s,i}}{x_{s,i}}\,\frac{\mathrm d x_{s,i}}{\mathrm d t}\)</span>.</blockquote>
</div>
<div class="section" id="dissipative-components">
<h4>Dissipative components</h4>
<p>The power <span class="math">\(D_d\)</span> instantaneously dissipated by the dissipative component <span class="math">\(d\in [1,\,\cdots,\,n_D]\)</span> is expressed with respect to an appropriate dissipation variable <span class="math">\(w_d\)</span>: <span class="math">\(D_d(t)\equiv D_d(w_d(t))\geq 0\)</span>. Typically, for a linear resistance <span class="math">\(R\)</span>, <span class="math">\(w_R\)</span> can be a current <span class="math">\(w_R=i_R\)</span> and <span class="math">\(D_R(i_R)=R\cdot i_R^2\)</span>.</p>
<p>As for storage components, a mapping of the dissipative power variables (<span class="math">\(v_d\)</span>, <span class="math">\(id\)</span>) is provided, based on the factorization <span class="math">\(D_d(w_d)=w_d\,z_d(w_d)\)</span>, introducing a dissipation function <span class="math">\(z_d\)</span>.
For the resistance, <span class="math">\(i_R=w_R\)</span> and <span class="math">\(V_R=R\,i_R=z_R(w_R)\)</span>.</p>
</div>
<div class="section" id="source-components">
<h4>Source components</h4>
<p>The power instantaneously provided to the system through external port p∈[1⋯nP]
is Sp(t), and we arrange the source variables (vp,ip) in two vectors: one is considered as an input up, and the other as the associated output yp, so that the power received from sources on port p is Sp=yp⋅up=−vp⋅ip (receiver convention, with vp⋅ip
the power received by the sources).</p>
</div>
</div>
<div class="section" id="conservative-interconnection">
<h3>Conservative Interconnection</h3>
<p>The interconnection of the components is achieved by relating all the voltages and currents through the application of the Kirchhoff’s laws to the interconnection network (schematic). This defines a conservative interconnection, according to Tellegen’s theorem recalled below (see also [26] and [27] §9.4).
Theorem 1 (Tellegen). Consider an electronic circuit made of N edges defined in same convention (here receiver), with individual voltages v=(v1,⋯,vN)⊺
and currents in=(i1,⋯,iN)⊺ which comply with the Kirchhoff’s laws. Then
v⊺⋅i=0.
(2)
A direct consequence of (2) is that no power is created nor lost in the structure: v⊺⋅i=∑Ni=1Pn=0
, with Pn=vn⋅in the power received by edge n, thus defining a conservative interconnection (Tellegen’s theorem is a special case of a more general interconnection structure, namely, the Dirac structure (see [23] §2.1.2 for details)). Now, denote (vs,is), (vd,id), and (vp,ip) the sets of all the power variables associated with storage components, dissipative components, and sources (respectively), and v=(v⊺s,v⊺d,v⊺p)⊺, i=(i⊺s,i⊺d,i⊺p)⊺ the vectors of all the power variables. Then, Tellegen’s theorem restores the power balance (1) with
v⊺⋅i==v⊺s⋅is+v⊺d⋅id+v⊺p⋅ip∇H⊺(x)⋅dxdtdEdt+z(w)⊺⋅wD−u⊺⋅yS,
(3)
where ∇H:RnS→RnS denotes the gradient of the total energy E=H(x)=∑nSs=1hs(xs) with respect to (w.r.t.) the vector of the states [x]s=xs, and function z:RnD→RnD denotes the collection of functions zd w.r.t. the vector w∈RnD of [w]d=wd so that z(w)⊺⋅w=∑nDd=1Dd(wd)
is the total dissipated power.
The above description of storage components, dissipative components, and source, along with the conservative interconnection stated by the Kirchhoff’s laws, constitute the minimal definition of a port-Hamiltonian system (PHS) (see [23] §2.2). In this work, we focus on circuits that admit an explicit realization of PHS, for which the quantities b=(b1,⋯,bN)⊺=(dxdt,w,−y)⊺
(with bn=vn or bn=in) can be expressed as linear combinations of the remaining N powers variables organized in the dual vector a=(a1,⋯,aN)⊺=(∇H(x),z(w),u)⊺ (with an=in if bn=vn or an=vn if bn=in):
b=J⋅a.
(4)
Then, a⊺⋅b=a⊺⋅J⋅a=0
from Tellegen’s theorem, so that the matrix J is necessarily skew-symmetric (J⊺=−J). More precisely, we consider the following algebraic-differential system of equations
⎛⎝⎜⎜dxdtw−y⎞⎠⎟⎟b=⎛⎝⎜⎜JxK⊺Gx⊺−KJwGw⊺−Gx−GwJy⎞⎠⎟⎟J⋅⎛⎝⎜⎜∇H(x)z(w)u⎞⎠⎟⎟a,
(5)
where matrices Jx, Jw, Jy are skew-symmetric. The significance of the structure matrices is the following:</p>
<p>Jx∈RnS×nS</p>
<blockquote>
expresses the conservative power exchanges between storage components (this corresponds to the so-called J
matrix in classical Hamiltonian systems);</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">&lt;string&gt;</tt>, line 98)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="docutils">
<dt>Jw∈RnD×nD</dt>
<dd>expresses the conservative power exchanges between dissipative components;</dd>
<dt>Jy∈RnP×nP</dt>
<dd>expresses the conservative power exchanges between ports (direct connections of inputs to outputs);</dd>
<dt>K∈RnS×nD</dt>
<dd>expresses the conservative power exchanges between the storage components and the dissipative components;</dd>
<dt>Gx∈RnS×nP</dt>
<dd>expresses the conservative power exchanges between ports and storage components (input gain matrix);</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">&lt;string&gt;</tt>, line 106)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>Gw∈RnD×nP</p>
<blockquote>
expresses the conservative power exchanges between ports and dissipative components (input gain matrix).</blockquote>
<p>The PHS (5) fulfills the definition of passivity (e.g., [16]) according to the following property.
Property 1 (Power Balance). The variation of the total energy E=H(x)
of a system governed by (5) is given by (1), with D=z(w)⊺⋅w≥0 the total dissipated power, and S=u⊺⋅y
the total power incoming on external ports.
Proof.  We have a⊺⋅b=dEdt+D−S
. Now a⊺⋅b=a⊺⋅J⋅a=0 since J
is skew-symmetric. ☐
Remark 1 (Power variables). This work is devoted to the treatment of electronic circuits for which power variables are chosen as current and voltage. However, all the aforementioned definitions apply equally to multiphysical systems, provided an adapted set of power variables, generically denoted by flux (currents, velocities, magnetic flux variations) and efforts (voltages, forces, magnetomotive force), the product of which is a power (see [23] Table 1.1). This follows the bond-graph modeling approach [28,29], on which the PHS formalism is built (see [23] §1.6 and 2.1). The treatment of multiphysical audio systems in the PHS formalism can be found in [30] (electromechanical piano that includes mechanical, electrical, and magnetic phenomena) and [31] (§III.B) (modulated air flow for musical acoustics applications that includes mechanical and acoustical phenomena).</p>
<p>## 1.2. Example
Consider the resistor-inductor-capacitor (RLC) circuit in Figure 1, with nS=2
, nD=1, and nP=2, described as follows. For the linear inductance L, the state and the positive definite function can be the magnetic flux x1=ϕ and h1(ϕ)=ϕ2/(2L), so that vL=dh1/dx1 and iL=dx1dt. For the capacitance and the resitance, quantities are defined with x2=q and w=[iR]. Port variables are arranged as input u=[v1,v2]⊺ and output y=[−i1,−i2]⊺
(edges receiver convention).
Applsci 06 00273 g001 550
Figure 1. Resistor-inductor-capacitor (RLC) circuit (notations and orientations).
Applying Kirchhoff’s laws to this simple serial circuit yields
⎛⎝⎜⎜⎜⎜⎜⎜⎜vLiCiRi1i2⎞⎠⎟⎟⎟⎟⎟⎟⎟=⎛⎝⎜⎜⎜⎜⎜⎜⎜0+1+1+1−1−10000−10000−10000+10000⎞⎠⎟⎟⎟⎟⎟⎟⎟⋅⎛⎝⎜⎜⎜⎜⎜⎜⎜iLvCvRv1v2⎞⎠⎟⎟⎟⎟⎟⎟⎟.
From the constitutive laws of components, this equation restores the form (5) exactly, block by block. It provides the algebraic-differential equations that govern the system with input u
and output y
.
This work aims at simulating such passive systems by firstly generating Equation (5) associated to a given circuit, and secondly by deriving its numerical version so that a discrete power balance is satisfied.
Remark 2 (Reduction). The system (5) can be reduced by decomposing function z
into its linear and nonlinear parts. See Appendix A for details.</p>
</div>
<div class="section" id="references">
<h3>References</h3>
<table class="docutils citation" frame="void" id="fh2016" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="#id1">[FH2016]</a></td>
<td>Falaize, A., &amp; Hélie, T. (2016). Passive Guaranteed Simulation of Analog Audio Circuits: A Port-Hamiltonian Approach. Applied Sciences, 6(10), 273.</td>
</tr></tbody>
</table>
</div>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/theory/" rel="tag">theory</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../electronics/" rel="prev" title="Electronics">Previous post</a>
            </li>
            <li class="next">
                <a href="../storage-components/" rel="next" title="Storage components">Next post</a>
            </li>
        </ul></nav></aside><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'left', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2017         <a href="mailto:antoine.falaize@gmail.com">afalaize</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
